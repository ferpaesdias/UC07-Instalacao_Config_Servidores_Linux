# Gerenciamento de DNS no Samba 4 (Debian DC01)

Este documento detalha como adicionar zonas e registros DNS diretamente pelo terminal do Controlador de Domínio (DC01) utilizando o comando `samba-tool`.

<br>

## Pré-requisitos
* Acesso **root** ou **sudo** no servidor DC01.
* Conhecimento da senha do usuário **Administrator** do domínio.
* Nome do Domínio: `empresatech.example`

---

## Gerenciando Registros DNS (Records)

Os registros são os apontamentos individuais (ex: associar o nome "impressora" ao IP "192.168.100.55").

<br>

### Sintaxe Básica
O comando padrão segue esta estrutura:

```bash
samba-tool dns add <Servidor> <Zona> <Nome> <Tipo> <Dados> -U administrator
```

<br>

### A. Adicionar um Registro Tipo A (Host)

O registro **Tipo A** é o mais comum. Ele liga um *Nome* a um IPv4.

<br>

Vamos criar os apontamentos usados neste ambiente:

```bash
samba-tool dns add dc01 empresatech.example dc02 A 192.168.100.201 -U administrator
samba-tool dns add dc01 empresatech.example dhcp01 A 192.168.100.202 -U administrator
samba-tool dns add dc01 empresatech.example fs01 A 192.168.100.203 -U administrator
```
---

### B. Adicionar um Registro CNAME (Alias/Apelido)

O **CNAME** cria um apelido (alias) para um nome já existente. Útil quando um servidor hospeda vários serviços.

Exemplo: Criar o apelido `fileserver` que redireciona para fs01.empresatech.example.

```bash
samba-tool dns add dc01 empresatech.example fileserver CNAME fs01.empresatech.example -U administrator
```
---

### C. Remover um Registro
Se você errou ou o servidor mudou, use o comando delete. A sintaxe é idêntica ao add.

Sintaxe:

```bash
samba-tool dns delete <Servidor> <Zona> <Nome> <Tipo> <Dados> -U administrator
```
---

## Gerenciando Zonas DNS

Uma "Zona" é como se fosse um domínio ou um intervalo de IPs que o servidor gerencia.

<br>

### A. Criar Zona de Pesquisa Reversa 

A **Zona Reversa** permite descobrir o nome de uma máquina através do IP (fundamental para diagnósticos de rede e logs).

O nome da zona deve ser a sua sub-rede escrita ao contrário, seguida de `.in-addr.arpa`.

* Se sua rede é `192.168.100.X`
* O nome da zona será: `100.168.192.in-addr.arpa`

<br>

Comando para criar uma Zona Reversa:

```bash
samba-tool dns zonecreate dc01 100.168.192.in-addr.arpa -U administrator
```
--- 

## Listando Registros

Para ver o que existe dentro do seu DNS atualmente.

Listar todos os registros da zona principal:

```bash
samba-tool dns query dc01 empresatech.example @ ALL -U administrator
```
---

## Resumo de Tipos de Registros Comuns

| Tipo | Descrição | Exemplo de Uso |
| --- | --- | ---| 
| A | Host (IPv4) | Servidores, Impressoras, PCs |
| CNAME	| Alias (Apelido)	| www, ftp, mail apontando para um host |
| PTR	| Ponteiro (Reverso) |	IP -> Nome (criado na zona reversa) |
| MX | Mail Exchange | Aponta para o servidor de E-mail |
| TXT	| Texto | Validações de segurança (SPF, Chaves) |

---